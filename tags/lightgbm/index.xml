<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>LightGBM on Chang Luo</title>
    <link>https://luochang212.github.io/tags/lightgbm/</link>
    <description>Recent content in LightGBM on Chang Luo</description>
    <generator>Hugo</generator>
    <language>en-us</language>
    <lastBuildDate>Sat, 13 Apr 2024 00:00:00 +0000</lastBuildDate>
    <atom:link href="https://luochang212.github.io/tags/lightgbm/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>LightGBM 工程实践</title>
      <link>https://luochang212.github.io/posts/lightgbm_practice/</link>
      <pubDate>Sat, 13 Apr 2024 00:00:00 +0000</pubDate>
      <guid>https://luochang212.github.io/posts/lightgbm_practice/</guid>
      <description>&lt;blockquote&gt;&#xA;&lt;p&gt;LightGBM 是一种梯度提升树算法，可用于排序、分类和回归任务。本文由一系列 Jupyter Notebook 串成，介绍如何使用 LightGBM 训练二分类模型。本项目使用的数据集是 &lt;a href=&#34;https://archive.ics.uci.edu/dataset/2/adult&#34; target=&#34;_blank&#34;&gt;adult&lt;/a&gt; (・ω&amp;lt; )★&lt;/p&gt;&lt;/blockquote&gt;&#xA;&lt;p&gt;GitHub 项目地址：&lt;a href=&#34;https://github.com/luochang212/lightgbm-binary&#34; target=&#34;_blank&#34;&gt;lightgbm-binary&lt;/a&gt;&lt;/p&gt;&#xA;&lt;h3 id=&#34;-本文亮点&#34;&gt;🚀 本文亮点&lt;/h3&gt;&#xA;&lt;ul&gt;&#xA;&lt;li&gt;✅ 使用 Optuna 做超参数寻优&lt;/li&gt;&#xA;&lt;li&gt;✅ 使用 Treelite 做推理加速&lt;/li&gt;&#xA;&lt;li&gt;✅ 使用 Graphviz 做决策树模型可视化&lt;/li&gt;&#xA;&lt;li&gt;✅ 使用 &lt;code&gt;scale_pos_weight&lt;/code&gt; 参数，解决样本不均衡问题&lt;/li&gt;&#xA;&lt;li&gt;✅ 对标签概率生成标签的阈值寻优 (&lt;code&gt;y_pred -&amp;gt; y&lt;/code&gt;)，详见 &lt;code&gt;util.gen_threshold&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;✅ 编写自适应学习率衰减函数提高 AUC，详见 &lt;code&gt;util.AdaptiveLearningRate&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;✅ 编写一站式评估函数，可一次性输出多种指标，包括 accuracy, precision, recall, f1_score, auc, cross-entropy loss, confusion matrix，详见 &lt;code&gt;util.eval_binary&lt;/code&gt;&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;p&gt;✨ 注意：以下代码运行时依赖 &lt;a href=&#34;https://github.com/luochang212/lightgbm-binary/blob/main/util.py&#34; target=&#34;_blank&#34;&gt;util.py&lt;/a&gt; 文件&lt;/p&gt;&#xA;&lt;h3 id=&#34;一数据可视化&#34;&gt;一、数据可视化&lt;/h3&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;导入数据&lt;/li&gt;&#xA;&lt;li&gt;统计描述&#xA;&lt;ul&gt;&#xA;&lt;li&gt;&lt;code&gt;describe()&lt;/code&gt; 方法&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;info()&lt;/code&gt; 方法&lt;/li&gt;&#xA;&lt;li&gt;统计各字段枚举值数量&lt;/li&gt;&#xA;&lt;li&gt;查看字段下所有枚举值&lt;/li&gt;&#xA;&lt;li&gt;查看空值个数&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;可视化&#xA;&lt;ul&gt;&#xA;&lt;li&gt;标号的值的比例&lt;/li&gt;&#xA;&lt;li&gt;小提琴图 (Violin Plot)&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;center&gt;&#xA;&lt;button class=&#34;demo-btn&#34; onclick=&#34;window_on(&#39;https://nbviewer.jupyter.org/github/luochang212/lightgbm-binary/blob/main/1.数据可视化.ipynb&#39;)&#34;&gt;查看示例&lt;/button&gt;&#xA;&lt;/center&gt;&#xA;&lt;h3 id=&#34;二预处理与特征选择&#34;&gt;二、预处理与特征选择&lt;/h3&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;预处理&#xA;&lt;ul&gt;&#xA;&lt;li&gt;标签编码&lt;/li&gt;&#xA;&lt;li&gt;更好的编码方式？&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;初次训练&#xA;&lt;ul&gt;&#xA;&lt;li&gt;使用 &lt;code&gt;lgb.LGBMClassifier&lt;/code&gt; 进行训练&lt;/li&gt;&#xA;&lt;li&gt;使用原生 API 进行训练&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;简单评估&lt;/li&gt;&#xA;&lt;li&gt;模型存储与导入&#xA;&lt;ul&gt;&#xA;&lt;li&gt;模型存储&lt;/li&gt;&#xA;&lt;li&gt;模型导入&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;特征选择&#xA;&lt;ul&gt;&#xA;&lt;li&gt;计算特征的重要程度&lt;/li&gt;&#xA;&lt;li&gt;多次实验求均值&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;center&gt;&#xA;&lt;button class=&#34;demo-btn&#34; onclick=&#34;window_on(&#39;https://nbviewer.jupyter.org/github/luochang212/lightgbm-binary/blob/main/2.预处理与特征选择.ipynb&#39;)&#34;&gt;查看示例&lt;/button&gt;&#xA;&lt;/center&gt;&#xA;&lt;h3 id=&#34;三超参数微调&#34;&gt;三、超参数微调&lt;/h3&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;简单的例子&lt;/li&gt;&#xA;&lt;li&gt;稍微复杂的例子：随机森林&#xA;&lt;ul&gt;&#xA;&lt;li&gt;导入数据&lt;/li&gt;&#xA;&lt;li&gt;one-hot 编码&lt;/li&gt;&#xA;&lt;li&gt;训练&lt;/li&gt;&#xA;&lt;li&gt;评估&lt;/li&gt;&#xA;&lt;li&gt;超参数微调&lt;/li&gt;&#xA;&lt;li&gt;使用微调后的超参数训练&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;LightGMB 超参数微调&#xA;&lt;ul&gt;&#xA;&lt;li&gt;单次训练&lt;/li&gt;&#xA;&lt;li&gt;超参数寻优&lt;/li&gt;&#xA;&lt;li&gt;使用微调后的超参数训练&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;学习率衰减&#xA;&lt;ul&gt;&#xA;&lt;li&gt;指数衰减&lt;/li&gt;&#xA;&lt;li&gt;自适应衰减&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;center&gt;&#xA;&lt;button class=&#34;demo-btn&#34; onclick=&#34;window_on(&#39;https://nbviewer.jupyter.org/github/luochang212/lightgbm-binary/blob/main/3.超参数微调.ipynb&#39;)&#34;&gt;查看示例&lt;/button&gt;&#xA;&lt;/center&gt;&#xA;&lt;h3 id=&#34;四训练与评估&#34;&gt;四、训练与评估&lt;/h3&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;基础模型&lt;/li&gt;&#xA;&lt;li&gt;N 折交叉验证&lt;/li&gt;&#xA;&lt;li&gt;超参寻优：N 折交叉验证&lt;/li&gt;&#xA;&lt;li&gt;使用微调后的超参数训练&lt;/li&gt;&#xA;&lt;li&gt;阈值选择 (&lt;code&gt;y_pred -&amp;gt; y&lt;/code&gt;)&#xA;&lt;ul&gt;&#xA;&lt;li&gt;使用 &lt;code&gt;np.rint&lt;/code&gt;&lt;/li&gt;&#xA;&lt;li&gt;尝试：考虑原标号的分布&#xA;&lt;ul&gt;&#xA;&lt;li&gt;训练标号的分布情况&lt;/li&gt;&#xA;&lt;li&gt;预测标号的概率密度函数 (PDF)&lt;/li&gt;&#xA;&lt;li&gt;预测标号的概率分布函数 (CDF)&lt;/li&gt;&#xA;&lt;li&gt;当 CDF = &lt;code&gt;训练数据 0 标号比例&lt;/code&gt; 时反推阈值&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;使用 optuna 寻优&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;li&gt;评估&#xA;&lt;ul&gt;&#xA;&lt;li&gt;混淆矩阵&lt;/li&gt;&#xA;&lt;li&gt;准确率&lt;/li&gt;&#xA;&lt;li&gt;精确率和召回率&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;f1&lt;/code&gt; 值&lt;/li&gt;&#xA;&lt;li&gt;&lt;code&gt;log_loss&lt;/code&gt; 交叉熵损失&lt;/li&gt;&#xA;&lt;li&gt;ROC 曲线 与 AUC&lt;/li&gt;&#xA;&lt;li&gt;一站式评估函数&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;center&gt;&#xA;&lt;button class=&#34;demo-btn&#34; onclick=&#34;window_on(&#39;https://nbviewer.jupyter.org/github/luochang212/lightgbm-binary/blob/main/4.训练与评估.ipynb&#39;)&#34;&gt;查看示例&lt;/button&gt;&#xA;&lt;/center&gt;&#xA;&lt;h2 id=&#34;五加速推理&#34;&gt;五、加速推理&lt;/h2&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;导入模型和数据&lt;/li&gt;&#xA;&lt;li&gt;使用 Treelite 加速推理&#xA;&lt;ul&gt;&#xA;&lt;li&gt;推理速度&lt;/li&gt;&#xA;&lt;li&gt;推理准度&lt;/li&gt;&#xA;&lt;li&gt;通用函数&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;center&gt;&#xA;&lt;button class=&#34;demo-btn&#34; onclick=&#34;window_on(&#39;https://nbviewer.jupyter.org/github/luochang212/lightgbm-binary/blob/main/5.加速推理.ipynb&#39;)&#34;&gt;查看示例&lt;/button&gt;&#xA;&lt;/center&gt;&#xA;&lt;h2 id=&#34;六部署&#34;&gt;六、部署&lt;/h2&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;模型训练&lt;/li&gt;&#xA;&lt;li&gt;模型部署&#xA;&lt;ul&gt;&#xA;&lt;li&gt;离线部署&lt;/li&gt;&#xA;&lt;li&gt;在线部署&lt;/li&gt;&#xA;&lt;/ul&gt;&#xA;&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;center&gt;&#xA;&lt;button class=&#34;demo-btn&#34; onclick=&#34;window_on(&#39;https://nbviewer.jupyter.org/github/luochang212/lightgbm-binary/blob/main/6.部署.ipynb&#39;)&#34;&gt;查看示例&lt;/button&gt;&#xA;&lt;/center&gt;&#xA;&lt;h2 id=&#34;七模型可视化&#34;&gt;七、模型可视化&lt;/h2&gt;&#xA;&lt;ol&gt;&#xA;&lt;li&gt;创建可交互的可视化界面&lt;/li&gt;&#xA;&lt;li&gt;将决策树存成 PNG / PDF&lt;/li&gt;&#xA;&lt;/ol&gt;&#xA;&lt;center&gt;&#xA;&lt;button class=&#34;demo-btn&#34; onclick=&#34;window_on(&#39;https://nbviewer.jupyter.org/github/luochang212/lightgbm-binary/blob/main/7.模型可视化.ipynb&#39;)&#34;&gt;查看示例&lt;/button&gt;&#xA;&lt;/center&gt;&#xA;&lt;p&gt;参考：&lt;/p&gt;</description>
    </item>
  </channel>
</rss>
