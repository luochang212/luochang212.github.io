<!DOCTYPE html>
<html>
    <head>
        <title>Monaco Speech Editor</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta http-equiv="Content-Type" content="text/html;charset=utf-8" >
        <link rel="stylesheet" href="./style.css">
        <script>
            
            
            
            
            
            
            
        </script>
    </head>
    <body>
        <div id="header">
            <div class="navbar">
                <button onclick="getEditorValue();">Speak Document</button>
                <button onclick="speakByLine();">Speak by line</button>
                
                <button onclick="cursorPosition();">Cursor Position</button>
                <span id="test"></span>
            </div>

            <div id="link">
                <a onclick="clickOpenNav()">&#9776;</a>
            </div>

            <div class="navbar-right">
                <button id="save" onclick="save();">Save</button>
            </div>

            

           

            

        </div>

        <div id="toolbar">
            
			<select class="language-picker"><option>apex</option><option>azcli</option><option>bat</option><option>c</option><option>clojure</option><option>coffeescript</option><option>cpp</option><option>csharp</option><option>csp</option><option>css</option><option>dockerfile</option><option>fsharp</option><option>go</option><option>graphql</option><option>handlebars</option><option>html</option><option>ini</option><option>java</option><option selected>javascript</option><option>json</option><option>kotlin</option><option>less</option><option>lua</option><option>markdown</option><option>msdax</option><option>mysql</option><option>objective-c</option><option>pascal</option><option>perl</option><option>pgsql</option><option>php</option><option>plaintext</option><option>postiats</option><option>powerquery</option><option>powershell</option><option>pug</option><option>python</option><option>r</option><option>razor</option><option>redis</option><option>redshift</option><option>ruby</option><option>rust</option><option>sb</option><option>scheme</option><option>scss</option><option>shell</option><option>sol</option><option>sql</option><option>st</option><option>swift</option><option>tcl</option><option>typescript</option><option>vb</option><option>xml</option><option>yaml</option></select>
        
            <input type="button" value="test" onclick="testFun()"/>

            

            <div class="voice-controller">
                
                <button onclick="backward();">
                    <img src="./images/step-backward-solid.svg" alt="step-backward-solid" height="20px">
                </button>
                <button onclick="play();">
                    <img id="play-pause" src="./images/play-solid.svg" alt="pause-solid" height="18px" style="padding-bottom:1px;">
                </button>
                <button onclick="forward();">
                    <img src="./images/step-forward-solid.svg" alt="step-forward-solid" height="20px">
                </button>
                <button onclick="doStop()">
                    <img src="./images/stop-solid.svg" alt="stop-solid" height="18px" style="padding-bottom:1px;">
                </button>
            </div>

            <sapn id="line-number">Line number: 1</sapn>
        </div>


        <div id="my-editor">
            <div id="container" style="height: h px;"></div>
        </div>

        <div id="overlay" onclick="closeByOverlay()"></div>

        <div id="mySidenav" class="sidenav">
            <div id="main">
                <h1>Setting</h1>

                <div class="option">
					<label for="rate">Rate</label>
                    <input type="range" min="0.1" max="2" step="0.1" name="rate" id="rate" value="1">
                    <div class="rate-value">1</div>
                </div>
                    
                <div class="option">
                    <label for="pitch">Pitch</label>
                    <input type="range" min="0.1" max="2" step="0.1" name="pitch" id="pitch" value="1">
                    <div class="pitch-value">1</div>
                </div>

                <select class="voice-select"></select>

                <br>

                <h1>Shortcuts</h1>
            </div>
        </div>

        
        <script src="./node_modules/monaco-editor/min/vs/loader.js"></script>
        <script src="./script.js"></script>
        <script>
            'use strict'
            var editor;

            require.config({ paths: { 'vs': './node_modules/monaco-editor/min/vs' }});

            require(['vs/editor/editor.main'], function() {
                editor = monaco.editor.create(document.getElementById('container'), {
                    value: [
                        '/* Write your code here. */',
                        '',
                        'function isDeleted(element) {',
                        '   var id_str = element.id;',
                        '   id_str = id_str.replace("btn","");',
                        '   var id_num = parseInt(id_str);',
                        '',
                        '   if (delete_flag == true) {',
                        '       delete_flag = false;',
                        '       subArray[id_num].isDelete = "true";',
                        '       element.value="Ã—";',
                        '   } else {',
                        '       delete_flag = true;',
                        '       subArray[id_num].isDelete = "false";',
                        '       element.value="";',
                        '   }',
                        '}',
                    ].join('\n'),
                    language: 'javascript',
                    wordWrap: "on",   
                    wrappingIndent: "indent"
                });

                
                
            });

            function getEditorValue() {
                inputTxt = editor.getValue();
                speak();
            }

            function getEditorValueByLine(x) {
                inputTxt = editor.getModel().getLineContent(x);
                speak();
            }

            function speakByLine() {
                var lineNumber = prompt("Please input the line number:", "");
                if (lineNumber == null || lineNumber == "") {
                    
                } else {
                    getEditorValueByLine(lineNumber);
                }
            }

            function cursorPosition() {
                alert('Line number: ' + editor.getPosition().lineNumber);
            }


            function save() {
                var filename = prompt("Please input filename:", "");
                if (filename == null || filename == "") {
                    
                } else {
                    var text = editor.getValue();
                    download(filename, text);
                }
            }

            function download(filename, text) {
                var element = document.createElement('a');
                element.setAttribute('href', 'data:text/plain;charset=utf-8,' + encodeURIComponent(text));
                element.setAttribute('download', filename);

                element.style.display = 'none';
                document.body.appendChild(element);

                element.click();

                document.body.removeChild(element);
            }

            var languageSelect = document.querySelector('.language-picker');

            function syntaxHighlight(langName) {
                monaco.editor.setModelLanguage(window.monaco.editor.getModels()[0], langName)
            }

            languageSelect.onchange = function() {
                syntaxHighlight(languageSelect.value);
                
            }

            var currentLineNumber = 1;
            var clickNumber = 0;

            function play() {
                var testTxt = editor.getModel().getLineContent(currentLineNumber);
                if(testTxt == "") {
                    return -1;
                }
                
                clickNumber ++;
                if (clickNumber == 1) {
                    pauseResume = 'R';
                    getEditorValueByLine(currentLineNumber);
                    document.getElementById("play-pause").src = "./images/pause-solid.svg";
                } else {
                    doPauseResume();
                }
            }

            function backward(LineNumber) {
                doStop();
                if (currentLineNumber <= 1) {
                    alert("This is the first line.");
                    return -1;
                } else {
                    currentLineNumber--;
                }
                document.getElementById("line-number").innerHTML = 'Line number: ' + currentLineNumber;
            }

            function forward() {
                doStop();
                var maxLine = editor.getModel().getLineCount();
                if (currentLineNumber >= maxLine) {
                    alert("This is the last line.");
                    return -1;
                } else {
                    currentLineNumber ++;
                }
                document.getElementById("line-number").innerHTML = 'Line number: ' + currentLineNumber;
            }

            function testFun() {
                document.getElementById("test").innerHTML = "dfas";
            }
            

            
            var clickCount = 0;

            function clickOpenNav() {
                clickCount += 1;
                if (clickCount%2 == 1) {
                    openNav();
                } else {
                    closeNav();
                }
            }

            function closeByOverlay() {
                clickCount += 1;
                off();
            }
            
            function openNav() {
                on();
                document.getElementById("mySidenav").style.width = "20%";
                
            }

            function closeNav() {
                document.getElementById("mySidenav").style.width = "0";
                document.body.style.backgroundColor = "white";
            }

            function on() {
                document.getElementById("overlay").style.display = "block";
            }

            function off() {
                closeNav();
                document.getElementById("overlay").style.display = "none";
            }


        </script>
    </body>
</html>